# Evolution API v2.1.1 - Docker Compose for Local Testing
# This is a reference for Evolution API configuration
# For Render, use the Docker image directly: atendai/evolution-api:v2.1.1

version: '3.8'

services:
  evolution-api:
    image: atendai/evolution-api:v2.1.1
    container_name: evolution-api
    restart: unless-stopped
    ports:
      - "8080:8080"
    environment:
      # Server Configuration
      - SERVER_URL=http://localhost:8080
      - PORT=8080
      
      # Database (PostgreSQL)
      - DATABASE_ENABLED=true
      - DATABASE_PROVIDER=postgresql
      - DATABASE_CONNECTION_URI=postgresql://user:password@host:5432/evolution
      
      # Redis (Optional but recommended)
      - REDIS_ENABLED=false
      # - REDIS_URI=redis://redis:6379
      
      # Security
      - API_KEY=your-secure-api-key-change-this
      - CONFIG_SESSION_PHONE_CLIENT=Chrome
      - CONFIG_SESSION_PHONE_NAME=Evolution API
      
      # Webhook Configuration
      - WEBHOOK_GLOBAL_ENABLED=true
      - WEBHOOK_GLOBAL_URL=http://localhost:5000/api/webhook
      - WEBHOOK_GLOBAL_WEBHOOK_BY_EVENTS=true
      
      # Logging
      - LOG_LEVEL=INFO
      - LOG_COLOR=false
      - LOG_BAILEYS=error
    volumes:
      - evolution_instances:/evolution/instances
      - evolution_store:/evolution/store
    networks:
      - evolution-network

  # Optional: Redis for production
  # redis:
  #   image: redis:7-alpine
  #   container_name: evolution-redis
  #   restart: unless-stopped
  #   ports:
  #     - "6379:6379"
  #   networks:
  #     - evolution-network

volumes:
  evolution_instances:
  evolution_store:

networks:
  evolution-network:
    driver: bridge

